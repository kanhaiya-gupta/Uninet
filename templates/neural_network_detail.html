{% extends "base.html" %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <!-- Header Section -->
        <div class="col-12 mb-4">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h2 class="mb-2">{{ name }}</h2>
                            <p class="text-muted mb-0">{{ description }}</p>
                        </div>
                        <a href="/neural-networks" class="btn btn-primary">
                            <i class="fas fa-arrow-left me-2"></i>Back to Neural Networks
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Overview Section -->
        <div class="col-md-6 mb-4">
            <div class="card h-100">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>Overview</h5>
                </div>
                <div class="card-body">
                    <p>{{ overview }}</p>
                </div>
            </div>
        </div>

        <!-- Use Cases Section -->
        <div class="col-md-6 mb-4">
            <div class="card h-100">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-list-check me-2"></i>Use Cases</h5>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        {% for use_case in use_cases %}
                        <li class="list-group-item">
                            <i class="fas fa-check-circle text-primary me-2"></i>{{ use_case }}
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>

        <!-- Architecture Section -->
        <div class="col-md-6 mb-4">
            <div class="card h-100">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-project-diagram me-2"></i>Architecture</h5>
                </div>
                <div class="card-body">
                    <div class="bg-light p-3 rounded">
                        <code>{{ architecture }}</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Implementation Section -->
        <div class="col-md-6 mb-4">
            <div class="card h-100">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-code me-2"></i>Implementation</h5>
                </div>
                <div class="card-body">
                    <pre class="bg-light p-3 rounded"><code>{{ implementation_code }}</code></pre>
                </div>
            </div>
        </div>

        <!-- Task Selection Section -->
        <div class="col-12 mb-4">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-tasks me-2"></i>Task Selection</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="taskType" class="form-label">Select Task Type:</label>
                                <select class="form-select" id="taskType" onchange="updateHyperparameters()">
                                    <option value="">Choose a task...</option>
                                    {% for task in tasks %}
                                    <option value="{{ task.id }}">{{ task.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Hyperparameters Section -->
        <div class="col-12 mb-4" id="hyperparametersSection" style="display: none;">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-sliders-h me-2"></i>Hyperparameters</h5>
                </div>
                <div class="card-body">
                    <form id="hyperparametersForm">
                        <div class="row" id="hyperparametersContent">
                            <!-- Dynamic hyperparameters will be inserted here -->
                        </div>
                        <div class="mt-3">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-play me-2"></i>Train Model
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .card {
        border: none;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
    }

    .card:hover {
        transform: translateY(-5px);
    }

    .card-header {
        border-bottom: none;
    }

    pre {
        margin: 0;
        white-space: pre-wrap;
        font-size: 0.9rem;
    }

    code {
        color: #2c3e50;
    }

    .list-group-item {
        border: none;
        padding: 0.75rem 0;
    }

    .list-group-item:not(:last-child) {
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }

    .form-label {
        font-weight: 500;
        color: #2c3e50;
    }

    .form-select, .form-control {
        border: 1px solid #e9ecef;
        border-radius: 5px;
        padding: 0.5rem;
    }

    .form-select:focus, .form-control:focus {
        border-color: #3498db;
        box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
    }
</style>

<script src="/static/js/hyperparameters.js"></script>
<script>
function updateHyperparameters() {
    const taskType = document.getElementById('taskType').value;
    const hyperparametersSection = document.getElementById('hyperparametersSection');
    const hyperparametersContent = document.getElementById('hyperparametersContent');
    
    if (!taskType) {
        hyperparametersSection.style.display = 'none';
        return;
    }

    const [networkType, task] = taskType.split('_');
    const params = window.hyperparameters[networkType][task];
    
    if (!params) {
        hyperparametersSection.style.display = 'none';
        return;
    }

    hyperparametersContent.innerHTML = params.map(param => {
        if (param.type === 'select') {
            return `
                <div class="col-md-6 mb-3">
                    <label for="${param.name}" class="form-label">${param.label}</label>
                    <select class="form-select" id="${param.name}" name="${param.name}">
                        ${param.options.map(opt => `<option value="${opt.value}">${opt.label}</option>`).join('')}
                    </select>
                </div>`;
        } else {
            return `
                <div class="col-md-6 mb-3">
                    <label for="${param.name}" class="form-label">${param.label}</label>
                    <input type="${param.type}" 
                           class="form-control" 
                           id="${param.name}" 
                           name="${param.name}"
                           min="${param.min || ''}"
                           max="${param.max || ''}"
                           step="${param.step || ''}"
                           value="${param.default || ''}"
                           required>
                </div>`;
        }
    }).join('');

    hyperparametersSection.style.display = 'block';
}

document.getElementById('hyperparametersForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const formData = new FormData(this);
    const params = {};
    for (let [key, value] of formData.entries()) {
        params[key] = value;
    }
    console.log('Training parameters:', params);
    // Here you would typically send these parameters to your backend
});
</script>
{% endblock %}